import{_ as k}from"./CodeBlockWrapper.vue_vue_type_script_setup_true_lang-D3UoTxyF.js";import{o as h,c as n,k as a,l as r,m as p,q as o,s as c,A as t,e as s,a6 as i}from"../modules/vue-DJcEiztt.js";import{I as d}from"./default-Cu-rJO8A.js";import{u as g,f as D}from"./context-DU5YJk2D.js";import"../modules/unplugin-icons-BdNrKeCQ.js";import"../index-0Gy_dhNt.js";import"../modules/shiki-B18_m8lD.js";const y=s("h2",null,"CRDT",-1),m=s("p",null,[i("CRDT 在文档协同上的核心思想是"),s("strong",null,"为每一个操作的字符分配唯一的标识符"),i("，同时为了保证收敛，即使删除字符也会为此保留元数据，这就导致对内存的开销是非常大的。 在YJS中的实现：每个 item 分配一个唯一 ID，其结构为 "),s("code",null,"ID(clientID, clock)"),i(" ，前者用于唯一标识某个 YDoc 对应的客户端，而后者则属于一种名为 "),s("a",{href:"https://en.wikipedia.org/wiki/Lamport_timestamp",target:"_blank"},"Lamport timestamp"),i(" 的逻辑时间戳，可以认为这就是个从零开始递增的计数器")],-1),A=s("pre",{class:"shiki shiki-themes vitesse-dark vitesse-light slidev-code",style:{"--shiki-dark":"#dbd7caee","--shiki-light":"#393a34","--shiki-dark-bg":"#121212","--shiki-light-bg":"#ffffff"}},[s("code",{class:"language-jsx"},[s("span",{class:"line"},[s("span",{style:{"--shiki-dark":"#758575DD","--shiki-light":"#A0ADA0"}},"// Yjs 中的 ID 源码")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-dark":"#CB7676","--shiki-light":"#AB5959"}},"class"),s("span",{style:{"--shiki-dark":"#5DA994","--shiki-light":"#2E8F82"}}," ID"),s("span",{style:{"--shiki-dark":"#666666","--shiki-light":"#999999"}}," {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-dark":"#CB7676","--shiki-light":"#AB5959"}},"  constructor"),s("span",{style:{"--shiki-dark":"#666666","--shiki-light":"#999999"}}," ("),s("span",{style:{"--shiki-dark":"#BD976A","--shiki-light":"#B07D48"}},"client"),s("span",{style:{"--shiki-dark":"#666666","--shiki-light":"#999999"}},": "),s("span",{style:{"--shiki-dark":"#5DA994","--shiki-light":"#2E8F82"}},"number"),s("span",{style:{"--shiki-dark":"#666666","--shiki-light":"#999999"}},","),s("span",{style:{"--shiki-dark":"#BD976A","--shiki-light":"#B07D48"}}," clock"),s("span",{style:{"--shiki-dark":"#666666","--shiki-light":"#999999"}},": "),s("span",{style:{"--shiki-dark":"#5DA994","--shiki-light":"#2E8F82"}},"number"),s("span",{style:{"--shiki-dark":"#666666","--shiki-light":"#999999"}},")"),s("span",{style:{"--shiki-dark":"#666666","--shiki-light":"#999999"}}," {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-dark":"#758575DD","--shiki-light":"#A0ADA0"}},"    // 客户端的唯一 ID")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-dark":"#C99076","--shiki-light":"#A65E2B"}},"    this"),s("span",{style:{"--shiki-dark":"#666666","--shiki-light":"#999999"}},"."),s("span",{style:{"--shiki-dark":"#BD976A","--shiki-light":"#B07D48"}},"client"),s("span",{style:{"--shiki-dark":"#666666","--shiki-light":"#999999"}}," ="),s("span",{style:{"--shiki-dark":"#BD976A","--shiki-light":"#B07D48"}}," client")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-dark":"#758575DD","--shiki-light":"#A0ADA0"}},"    // 逻辑时间戳")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-dark":"#C99076","--shiki-light":"#A65E2B"}},"    this"),s("span",{style:{"--shiki-dark":"#666666","--shiki-light":"#999999"}},"."),s("span",{style:{"--shiki-dark":"#BD976A","--shiki-light":"#B07D48"}},"clock"),s("span",{style:{"--shiki-dark":"#666666","--shiki-light":"#999999"}}," ="),s("span",{style:{"--shiki-dark":"#BD976A","--shiki-light":"#B07D48"}}," clock")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-dark":"#666666","--shiki-light":"#999999"}},"  }")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-dark":"#666666","--shiki-light":"#999999"}},"}")])])],-1),L={__name:"15",setup(_){const{$slidev:B,$nav:f,$clicksContext:u,$clicks:C,$page:x,$renderContext:I,$frontmatter:e}=g();return($,b)=>{const l=k;return h(),n(d,o(c(t(D)(t(e),14))),{default:a(()=>[y,m,r(l,p({},{ranges:[]}),{default:a(()=>[A]),_:1},16)]),_:1},16)}}};export{L as default};
